# =============================================================================
# Pentaho Docker Build Configuration
# =============================================================================
# Copy this file to .env and customize for your environment
#
# Usage:
#   cp .env.example .env
#   nano .env
#   ./build.sh
#
# =============================================================================

# -----------------------------------------------------------------------------
# Build Configuration
# -----------------------------------------------------------------------------

# Pentaho version number
# Must match the ZIP filename in stagedArtifacts/
PENTAHO_VERSION=11.0.0.0-237

# Edition: ee (Enterprise) or ce (Community)
EDITION=ee

# Include demo content: 1 (yes) or 0 (no)
# Demo content includes sample reports, dashboards, and data
INCLUDE_DEMO=0

# Docker image tag
# Format: registry/repository:tag
IMAGE_TAG=pentaho/pentaho-server:11.0.0.0-237

# Alternative image tags (optional)
# Uncomment to create multiple tags
# IMAGE_TAG_LATEST=pentaho/pentaho-server:latest
# IMAGE_TAG_MAJOR=pentaho/pentaho-server:11

# -----------------------------------------------------------------------------
# Build Arguments (Advanced)
# -----------------------------------------------------------------------------

# Installation path inside container
INSTALLATION_PATH=/opt/pentaho

# Base images for multi-stage build
UNPACK_BUILD_IMAGE=debian:trixie-slim
PACK_BUILD_IMAGE=debian:trixie-slim

# -----------------------------------------------------------------------------
# Runtime Configuration (Passed to Container)
# -----------------------------------------------------------------------------

# JVM Memory Settings
# Adjust based on available server resources
PENTAHO_MIN_MEMORY=2048m
PENTAHO_MAX_MEMORY=4096m

# JVM Additional Options
# Add custom Java options here (space-separated, must be quoted)
PENTAHO_DI_JAVA_OPTIONS="-Dfile.encoding=utf8 -Djava.awt.headless=true"

# Timezone
# Format: Continent/City (IANA timezone database)
# Examples: America/New_York, Europe/London, Asia/Tokyo
TZ=America/New_York

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------

# Database type: postgres, mysql, oracle, mssql
DB_TYPE=postgres

# Database connection details
# In K3s, use service name (e.g., "postgres")
DB_HOST=postgres
DB_PORT=5432

# Database names (Pentaho requires 3 databases)
DB_JACKRABBIT=jackrabbit
DB_QUARTZ=quartz
DB_HIBERNATE=hibernate

# Database users
DB_JCR_USER=jcr_user
DB_PENTAHO_USER=pentaho_user
DB_HIB_USER=hibuser

# NOTE: Database passwords should be stored in Kubernetes Secrets
# Not in this .env file for security reasons

# -----------------------------------------------------------------------------
# Enterprise Edition License (Optional)
# -----------------------------------------------------------------------------

# License URL (for automated license installation)
# Leave empty to skip license installation
# Formats supported:
#   - HTTP/HTTPS: http://server/path/to/license.lic
#   - File path: file:///path/to/license.lic
LICENSE_URL=

# -----------------------------------------------------------------------------
# Registry Configuration
# -----------------------------------------------------------------------------

# Push to registry after build: true or false
PUSH_TO_REGISTRY=false

# Registry configuration
# Uncomment and configure for private registries
# REGISTRY_URL=harbor.company.com
# REGISTRY_USERNAME=admin
# REGISTRY_PASSWORD=Harbor12345

# For Docker Hub, use:
# REGISTRY_URL=docker.io
# REGISTRY_USERNAME=your-dockerhub-username
# REGISTRY_PASSWORD=your-dockerhub-token

# -----------------------------------------------------------------------------
# K3s Integration
# -----------------------------------------------------------------------------

# Automatically load image into K3s after build: true or false
LOAD_INTO_K3S=false

# K3s namespace for deployment
K3S_NAMESPACE=pentaho

# K3s deployment name to update
K3S_DEPLOYMENT=pentaho-server

# -----------------------------------------------------------------------------
# Build Options
# -----------------------------------------------------------------------------

# Enable BuildKit: true or false
# BuildKit provides better caching and parallel builds
USE_BUILDKIT=true

# Build platform (for multi-architecture builds)
# Examples: linux/amd64, linux/arm64, linux/amd64,linux/arm64
BUILD_PLATFORM=linux/amd64

# No cache build: true or false
# Set to true to force clean build without cache
NO_CACHE=false

# Verbose build output: true or false
VERBOSE=false

# -----------------------------------------------------------------------------
# Testing Options
# -----------------------------------------------------------------------------

# Run tests after build: true or false
RUN_TESTS=true

# Test timeout in seconds
TEST_TIMEOUT=300

# -----------------------------------------------------------------------------
# Cleanup Options
# -----------------------------------------------------------------------------

# Remove intermediate images after build: true or false
CLEANUP_INTERMEDIATE=true

# Remove dangling images after build: true or false
CLEANUP_DANGLING=false

# -----------------------------------------------------------------------------
# Notification Options (Optional)
# -----------------------------------------------------------------------------

# Send notification on build completion: true or false
SEND_NOTIFICATION=false

# Notification webhook URL (Slack, Discord, etc.)
NOTIFICATION_WEBHOOK_URL=

# -----------------------------------------------------------------------------
# Custom Configuration Overlays
# -----------------------------------------------------------------------------

# Path to custom configuration directory
# Files will be copied to /docker-entrypoint-init in container
# Leave empty to skip
CUSTOM_CONFIG_PATH=

# -----------------------------------------------------------------------------
# Development/Debug Options
# -----------------------------------------------------------------------------

# Enable debug mode: true or false
# Prints additional information during build
DEBUG=false

# Preserve build context: true or false
# Keeps temporary files for troubleshooting
PRESERVE_BUILD_CONTEXT=false

# =============================================================================
# Example Configurations
# =============================================================================

# Example 1: Development Environment
# -----------------------------------
# PENTAHO_VERSION=11.0.0.0-237
# EDITION=ee
# INCLUDE_DEMO=1
# PENTAHO_MIN_MEMORY=1024m
# PENTAHO_MAX_MEMORY=2048m
# LOAD_INTO_K3S=true
# RUN_TESTS=true

# Example 2: Production Environment
# ----------------------------------
# PENTAHO_VERSION=11.0.0.0-237
# EDITION=ee
# INCLUDE_DEMO=0
# PENTAHO_MIN_MEMORY=4096m
# PENTAHO_MAX_MEMORY=8192m
# LICENSE_URL=https://company.com/licenses/pentaho-ee.lic
# PUSH_TO_REGISTRY=true
# REGISTRY_URL=harbor.company.com
# LOAD_INTO_K3S=false
# RUN_TESTS=true

# Example 3: CI/CD Pipeline
# --------------------------
# PENTAHO_VERSION=11.0.0.0-237
# EDITION=ee
# INCLUDE_DEMO=0
# IMAGE_TAG=harbor.company.com/pentaho/pentaho-server:${CI_COMMIT_TAG}
# PUSH_TO_REGISTRY=true
# RUN_TESTS=true
# SEND_NOTIFICATION=true
# NOTIFICATION_WEBHOOK_URL=${SLACK_WEBHOOK}

# =============================================================================
# Notes
# =============================================================================
#
# 1. This .env file is used by build.sh
# 2. DO NOT commit .env to version control (add to .gitignore)
# 3. Keep .env.example updated with new options
# 4. For K3s deployment, also update manifests/configmaps/pentaho-config.yaml
# 5. Secrets should be stored in Kubernetes Secrets, not in this file
#
# =============================================================================
